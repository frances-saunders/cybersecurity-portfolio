# Splunk integration for Snort alerts
# Two supported paths:
#  1) File monitoring of Snort fast/unified2 logs
#  2) HTTP Event Collector (HEC) via log-forwarder.py

# ---------- Option 1: File monitor ----------
# Place on UF/HF indexing server as appropriate
# Monitor Snort fast alert file; ensure sourcetype normalization
[monitor:///var/log/snort/alert_fast.log]
sourcetype = snort:fast
index = ids
disabled = false
crcSalt = <SOURCE>

# Recommended props for snort:fast
# $SPLUNK_HOME/etc/system/local/props.conf
[snort:fast]
TIME_PREFIX = \[
REPORT-snort = snort-kv
TRUNCATE = 0
SHOULD_LINEMERGE = false

# Transforms to extract key fields
# $SPLUNK_HOME/etc/system/local/transforms.conf
[snort-kv]
REGEX = \[(?<timestamp>[^\]]+)\]\s+(?<sig>\S+)\s+\[(?<sid>\d+):(?<rev>\d+)\]\s+(?<msg>.*?)\s+\{(?<proto>[^}]+)\}\s+(?<src>\S+)\s+->\s+(?<dst>\S+)
FORMAT = timestamp::$1 sig::$2 sid::$3 rev::$4 msg::$5 proto::$6 src::$7 dst::$8
WRITE_META = true

# ---------- Option 2: HEC (preferred for portability) ----------
# Configure HEC on Splunk and set:
#   SPLUNK_HEC_URL=https://splunk.example.com:8088/services/collector
#   SPLUNK_HEC_TOKEN (stored in Vault/Key Vault; not plaintext)
# Set index and sourcetype expectation:
#   index=ids, sourcetype=snort:json
